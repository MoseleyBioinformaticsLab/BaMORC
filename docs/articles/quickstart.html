<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with BaMORC • BaMORC</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with BaMORC">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BaMORC</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li>
  <a href="../articles/CLI_guide.html">CLI Guide</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">ChangeLog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/billchenxi/BaMORC">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting started with BaMORC</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MoseleyBioinformaticsLab/BaMORC/blob/master/vignettes/quickstart.Rmd"><code>vignettes/quickstart.Rmd</code></a></small>
      <div class="hidden name"><code>quickstart.Rmd</code></div>

    </div>

    
    
<div id="bamorc-quickstart-guide" class="section level1">
<h1 class="hasAnchor">
<a href="#bamorc-quickstart-guide" class="anchor"></a>BaMORC quickstart guide</h1>
<p>The goal of this document is to get you up and running with BaMORC as quickly as possible. BaMORC is designed as Bayesian Model Optimized Reference Correction (BaMORC) Method for Assigned and Unassigned Protein NMR Spectra. For a detailed explanation of the algorithm please refer to “<a href="https://doi.org/10.1007/s10858-018-0202-5">Automatic 13C chemical shift reference correction for unassigned protein NMR spectra</a>”.</p>
<p>There are two important parts to BaMORC: the <code><a href="../reference/bamorc.html">bamorc()</a></code>, reference correction function for assigned 13C protein NMR spectra, and the <code><a href="../reference/unassigned_bamorc.html">unassigned_bamorc()</a></code>, reference correction function for unassigned 13C protein NMR spectra. In the first section, you’ll learn about the basics of running both of the functions. In the second section, you will dive into the basics of input data process, and in third section, you’ll learn a little more on functions of the behind-the-scenes of the BaMORC algorithm.</p>
<div id="bamorc-basics" class="section level2">
<h2 class="hasAnchor">
<a href="#bamorc-basics" class="anchor"></a>BaMORC basics</h2>
<p>To make a correction, first load BaMORC, then call <code><a href="../reference/bamorc.html">bamorc()</a></code> or <code><a href="../reference/unassigned_bamorc.html">unassigned_bamorc()</a></code> with correct arguments:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(BaMORC)</a></code></pre></div>
<div id="for-assigned-protein-nmr-spectra" class="section level3">
<h3 class="hasAnchor">
<a href="#for-assigned-protein-nmr-spectra" class="anchor"></a>For assigned protein NMR spectra:</h3>
<p>Here we will using the built-in data to demonstrate the arguments that will be passed in the <code><a href="../reference/bamorc.html">bamorc()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">## Arguments:</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">sequence =<span class="st"> </span><span class="kw">paste</span>(RefDB_data<span class="op">$</span>carbonDat[[<span class="dv">1</span>]]<span class="op">$</span>AA, <span class="dt">collapse =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">secondary_structure =<span class="st"> </span><span class="kw">paste</span>(RefDB_data<span class="op">$</span>carbonDat[[<span class="dv">1</span>]]<span class="op">$</span>SS, <span class="dt">collapse =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">chemical_shifts_input =<span class="st"> </span>RefDB_data<span class="op">$</span>carbonDat[[<span class="dv">1</span>]][, <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>)]</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">from =<span class="st"> </span><span class="dv">-5</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">to =<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">## Running bamorc() function:</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw"><a href="../reference/bamorc.html">bamorc</a></span>(<span class="dt">sequence =</span> sequence, <span class="dt">secondary_structure =</span> secondary_structure, </a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    <span class="dt">chemical_shifts_input =</span> chemical_shifts_input, <span class="dt">from =</span> <span class="dv">-5</span>, </a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    <span class="dt">to =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [1] 0.0142443</span></a></code></pre></div>
<ul>
<li>
<code>sequence</code>: <string> the sequence of protein of interest with single-letter convention.</string>
</li>
<li>
<code>secondary_structure</code>: <string> the secondary structure information of the protein with with single-letter convention.</string>
</li>
<li>
<code>chemical_shifts_input</code>: &lt;data frame n by 2&gt; the carbon 13 chemical shift of the protein.</li>
<li>
<code>from</code> and <code>to</code>: <numeric> the upper- and lower-bound of optimization range. Value assigned to <code>from</code> must be lower than <code>to</code>.</numeric>
</li>
</ul>
<p>The length of the <code>sequence</code> and <code>secondary_structure</code> should be the same, if not pleasue assign <code>secondary_structure = NULL</code>, however, the peaklist groups number could be more or less than the length of the sequence. Since commonly the output of the spectra should have a little deviate from the sequence information.</p>
<p>Printing an argument object gives you some useful information: the actual format, the size, the object type, and if it’s a string.</p>
</div>
<div id="for-unassigned-protein-nmr-spectra" class="section level3">
<h3 class="hasAnchor">
<a href="#for-unassigned-protein-nmr-spectra" class="anchor"></a>For unassigned protein NMR spectra:</h3>
<p>Next we will using the built-in data to demonstrate the arguments that will be passed in the <code><a href="../reference/unassigned_bamorc.html">unassigned_bamorc()</a></code>. The output will be slight different each time runs due to the randomness of the optimization.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">## Arguments:enerate a temperary sample NMR spectra file and</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">## later will be removed.</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">sequence =<span class="st"> "RPAFCLEPPYAGPGKARIIRYFYNAAAGAAQAFVYGGVRAKRNNFASAADALAACAAA"</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="../reference/sample_data_generator.html">sample_data_generator</a></span>(<span class="dt">input_type =</span> <span class="st">"ssc_sample"</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">file_path =<span class="st"> "./bpti_HNcoCACB.txt"</span>  <span class="co"># temperary sample file path.</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">## Running unassigned_bamorc() function: unassigned_bamorc</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">## will take a while to run</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw"><a href="../reference/unassigned_bamorc.html">unassigned_bamorc</a></span>(<span class="dt">peakList_file_loc =</span> file_path, <span class="dt">sequence =</span> sequence, </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    <span class="dt">secondary_structure =</span> <span class="ot">NULL</span>, <span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">## Delete the temperary sample file.</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="kw">unlink</span>(<span class="st">"./bpti_HNcoCACB.txt"</span>)</a></code></pre></div>
</div>
</div>
</div>
<div id="the-data-processing" class="section level1">
<h1 class="hasAnchor">
<a href="#the-data-processing" class="anchor"></a>The data processing:</h1>
<p>The data passed in both above functions should be pre-processed. Luckly, we provided a varity of helper functions. I’ll show you how to process the data as following.</p>
<div id="the-sample-generating-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#the-sample-generating-functions" class="anchor"></a>The sample generating functions:</h2>
<p>There are three file reading functions within the BaMORC package: <code><a href="../reference/read_raw_file.html">read_raw_file()</a></code>, <code><a href="../reference/read_nmrstar_file.html">read_nmrstar_file()</a></code>, and <code><a href="../reference/read_db_file.html">read_db_file()</a></code>. Even though, these functions should handle a wide range of the input files, however, a good file formation are highly recommanded. You can check the sample file using the <code><a href="../reference/sample_data_generator.html">sample_data_generator()</a></code> with following code:</p>
<ul>
<li>
<p>Delimiter of white space:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">## Arguments:enerate a temperary sample NMR spectra file and</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">## later will be removed.</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">input_type =<span class="st"> "ws"</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="../reference/sample_data_generator.html">sample_data_generator</a></span>(<span class="dt">input_type =</span> input_type)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">## Running reading function</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">head</span>(<span class="kw"><a href="../reference/read_raw_file.html">read_raw_file</a></span>(<span class="dt">file_path =</span> <span class="st">"sample_input_ws.txt"</span>, <span class="dt">delim =</span> <span class="st">"ws"</span>))</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;   X1 = col_double(),</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;   X2 = col_double()</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; [1] "NHQDHNNFQTLPYVPCSTCEGNLACLSLCHIE"</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; # A tibble: 32 x 2</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;       X1    X2</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;  1  NA    38.6</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;  2  NA    28.8</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;  3  56.3  30.4</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;  4  54.4  41.3</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;  5  NA    28.8</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt;  6  55.1  38.9</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt;  7  NA    38.8</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt;  8  NA    39.3</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt;  9  NA    30.3</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; 10  62.1  69.8</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; # ... with 22 more rows</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="kw">unlink</span>(<span class="st">"sample_input_ws.txt"</span>)</a></code></pre></div>
</li>
<li>
<p>Delimiter of comma:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">## Arguments:enerate a temperary sample NMR spectra file and</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## later will be removed.</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">input_type =<span class="st"> "csv"</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="../reference/sample_data_generator.html">sample_data_generator</a></span>(<span class="dt">input_type =</span> input_type)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">## Running reading function</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw">head</span>(<span class="kw"><a href="../reference/read_raw_file.html">read_raw_file</a></span>(<span class="dt">file_path =</span> <span class="st">"sample_input.csv"</span>, <span class="dt">delim =</span> <span class="st">"comma"</span>))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;   X1 = col_double(),</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;   X2 = col_double()</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; Warning in rbind(names(probs), probs_f): number of columns of result is not</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; a multiple of vector length (arg 2)</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; Warning: 1 parsing failure.</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; row # A tibble: 1 x 5 col     row col   expected  actual    file               expected   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;              actual 1    33 &lt;NA&gt;  2 columns 1 columns 'sample_input.csv' file # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; [1] "NHQDHNNFQTLPYVPCSTCEGNLACLSLCHIE"</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; # A tibble: 33 x 2</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt;       X1    X2</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt;  1  NA    38.6</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt;  2  NA    28.8</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt;  3  56.3  30.4</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt;  4  54.4  41.3</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt;  5  NA    28.8</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt;  6  55.1  38.9</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt;  7  NA    38.8</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt;  8  NA    39.3</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="co">#&gt;  9  NA    30.3</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="co">#&gt; 10  62.1  69.8</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="co">#&gt; # ... with 23 more rows</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="kw">unlink</span>(<span class="st">"sample_input.csv"</span>)</a></code></pre></div>
</li>
<li>
<p>Delimiter of semicolon:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">## Arguments:enerate a temperary sample NMR spectra file and</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">## later will be removed.</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">input_type =<span class="st"> "sc"</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw"><a href="../reference/sample_data_generator.html">sample_data_generator</a></span>(<span class="dt">input_type =</span> input_type)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">## Running reading function</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="kw">head</span>(<span class="kw"><a href="../reference/read_raw_file.html">read_raw_file</a></span>(<span class="dt">file_path =</span> <span class="st">"sample_input_sc.txt"</span>, <span class="dt">delim =</span> <span class="st">"semicolon"</span>))</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;   X1 = col_double(),</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;   X2 = col_double()</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; [1] "NHQDHNNFQTLPYVPCSTCEGNLACLSLCHIE"</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; # A tibble: 32 x 2</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt;       X1    X2</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt;  1  NA    38.6</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;  2  NA    28.8</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt;  3  56.3  30.4</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt;  4  54.4  41.3</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt;  5  NA    28.8</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;  6  55.1  38.9</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;  7  NA    38.8</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt;  8  NA    39.3</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt;  9  NA    30.3</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; 10  62.1  69.8</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; # ... with 22 more rows</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="kw">unlink</span>(<span class="st">"sample_input_sc.txt"</span>)</a></code></pre></div>
</li>
</ul>
</div>
<div id="the-reading-functions-will-return-sequence-and-chemical-shifts" class="section level2">
<h2 class="hasAnchor">
<a href="#the-reading-functions-will-return-sequence-and-chemical-shifts" class="anchor"></a>The reading functions will return sequence and chemical shifts:</h2>
<ul>
<li><p><code><a href="../reference/read_raw_file.html">read_raw_file()</a></code>: parses user-provided file in customed format as show above examples.</p></li>
<li><p><code><a href="../reference/read_nmrstar_file.html">read_nmrstar_file()</a></code>: parses user-provided file in BMRB Star 2/3 format.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">## Download a BMRB file</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(BMRBr)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="http://www.rdocumentation.org/packages/BMRBr/topics/bmrb_download">bmrb_download</a></span>(<span class="dv">4020</span>, <span class="dt">output_dir =</span> <span class="st">"./"</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## Read in BMRB file and procec</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">file_path =<span class="st"> "bmr4020.str"</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">head</span>(<span class="kw"><a href="../reference/read_nmrstar_file.html">read_nmrstar_file</a></span>(<span class="dt">file_path =</span> file_path))</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">## Delete downloaded BMRB file</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="kw">unlink</span>(<span class="st">"./bmr4020.str"</span>)</a></code></pre></div>
<ul>
<li>
<code><a href="../reference/read_db_file.html">read_db_file()</a></code>: parses file from BMRB by a given entry ID.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">id =<span class="st"> </span><span class="dv">4022</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_db_file.html">read_db_file</a></span>(<span class="dt">id =</span> id)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw">head</span>(output[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; [1] "A" "S" "P" "D" "W" "G"</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw">head</span>(output[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt;       CA   CB</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 1   51.9 19.4</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 112 57.5 63.3</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 183 63.1 32.2</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; 194 54.6 41.3</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; 205 54.7 31.4</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; 216 45.4   NA</span></a></code></pre></div>
</div>
<div id="estimating-econdary-structure-from-sequence" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-econdary-structure-from-sequence" class="anchor"></a>Estimating econdary structure from sequence:</h2>
<p>One important part of the optmization for referencing correction value is through providing the secondary structue information basin protein sequence. This is done through the <a href="http://www.compbio.dundee.ac.uk/jpred/index.html">JPred</a> and jpredapi.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">protein_sequence &lt;-<span class="st"> "MQVWPIEGIKKFETLSYLPPLTVEDLLKQI"</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">secondary_structure &lt;-<span class="st"> </span><span class="kw"><a href="../reference/jpred_fetcher.html">jpred_fetcher</a></span>(<span class="dt">protein_sequence =</span> protein_sequence)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">secondary_structure</a></code></pre></div>
</div>
<div id="behind-the-scenes-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#behind-the-scenes-functions" class="anchor"></a>Behind-the-scenes functions</h2>
<p>The BaMORC algorithms relys minimize the difference betwee the actual relative cummulative frequence (RCF) of the protein sequence and estimated RCF from the chemical shifts information. The functions make the algorithm possible are showing below with examples, for detailed function descriptions, please see the reference.:</p>
<ul>
<li>
<code><a href="http://www.rdocumentation.org/packages/BaMORC/topics/calculate_aa_prob">calculate_aa_prob()</a></code>: returns the probability (density) for a certain type of amino acid based on a chi-squared statistics wtih 2 degrees of freedom.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="http://www.rdocumentation.org/packages/BaMORC/topics/calculate_aa_prob">calculate_aa_prob</a></span>(<span class="dt">chi_squared_stat =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>), <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; [1] 0.4876550 0.4756147 0.3894004</span></a></code></pre></div>
<ul>
<li>
<code><a href="../reference/calculate_chi_squared_stat.html">calculate_chi_squared_stat()</a></code>: given a pair of alpha and beta carbons chemical shifts, this function will return a list of caculated chisquare statistics based on the combination of amino acid typings and secondary structures. Here we illustrate with a pair of chemical shifts from alpha and beta carbon.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/calculate_chi_squared_stat.html">calculate_chi_squared_stat</a></span>(<span class="dt">cacb_pair =</span> <span class="kw">c</span>(<span class="dv">54</span>, <span class="dv">45</span>))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt;     AA                H                 B                C</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;  1:  A 1023.16868895477  169.099242775473 469.048336795045</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt;  2:  B 180.178895468627  54.4937018085712 74.2438106347521</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;  3:  C 24.0426461856623  6.02618817827703 23.2477754200126</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;  4:  D 14.4848786940741  2.79850128029531 10.2715883462805</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt;  5:  E 13.3897615181103  1.88818580572447 4.60208889084118</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;  6:  F 165.514869003217  77.9438324817418 62.5815610717518</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;  7:  H 321.477487110107  53.4257171238817 91.6072511229365</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;  8:  I 253.099344063356  44.4933903131377 94.8605497904786</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;  9:  K 128.989994525817  35.9002492383691 39.0974374716513</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; 10:  L 100.123349476134  19.1632752720135 22.6939781262421</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; 11:  M 14.8396700069463 0.383003397426531 2.60892370474794</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; 12:  N 222.558693666307  34.5192736984713 53.7891077582836</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; 13:  P 89.4591494720313    19.26900894692 26.5279676961367</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; 14:  Q 40.3446974047416  5.81357432329253 11.1635747587969</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; 15:  R 267.220874922648  179.412483703255 236.676686103036</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; 16:  S 203.258956942293  177.779740165393 190.175848300641</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt; 17:  T 451.922344250779  363.817995197962 408.684228724244</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt; 18:  V 58.3956321465275  6.77558973670799 13.8132678105348</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt; 19:  W 127.135809610673  63.1703556188059 77.6629767003917</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt; 20:  Y 358.237467618581  47.5540232633832 80.5896644421314</span></a></code></pre></div>
<ul>
<li>
<code><a href="http://www.rdocumentation.org/packages/BaMORC/topics/calculate_rcf">calculate_rcf()</a></code>: calculates the relative cummulative freqeucny of amino acid and secondary structure combination.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">## Arguments:</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">sequence =<span class="st"> </span><span class="kw">paste</span>(RefDB_data<span class="op">$</span>carbonDat[[<span class="dv">1</span>]]<span class="op">$</span>AA, <span class="dt">collapse =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">secondary_structure =<span class="st"> </span><span class="kw">paste</span>(RefDB_data<span class="op">$</span>carbonDat[[<span class="dv">1</span>]]<span class="op">$</span>SS, <span class="dt">collapse =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">## Function:</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="http://www.rdocumentation.org/packages/BaMORC/topics/calculate_rcf">calculate_rcf</a></span>(<span class="dt">sequence =</span> sequence, <span class="dt">secondary_structure =</span> secondary_structure)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;  [1] "S-C" "I-C" "P-C" "C-B" "L-B" "L-B" "S-B" "P-C" "W-B" "S-B" "E-B"</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; [12] "W-B" "S-B" "D-C" "C-B" "S-B" "V-B" "T-C" "C-C" "K-B" "M-B" "R-B"</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; [23] "T-B" "R-B" "Q-B" "R-B" "M-B" "L-B" "K-B" "S-C" "L-C" "A-C" "E-C"</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; [34] "L-C" "D-C" "C-C" "N-C" "E-C" "D-C" "L-B" "E-B" "Q-B" "A-B" "E-B"</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; [45] "K-B" "C-B" "M-B" "L-B" "P-B" "E-B" "C-C" "P-C"</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt;    AA_SS       Freq</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; 1    A-B 0.01923077</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; 2    A-C 0.01923077</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt; 3    C-B 0.05769231</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; 4    C-C 0.05769231</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; 5    D-C 0.05769231</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; 6    E-B 0.07692308</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; 7    E-C 0.03846154</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; 8    I-C 0.01923077</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; 9    K-B 0.05769231</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; 10   L-B 0.09615385</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; 11   L-C 0.03846154</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt; 12   M-B 0.05769231</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt; 13   N-C 0.01923077</span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"><span class="co">#&gt; 14   P-B 0.01923077</span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co">#&gt; 15   P-C 0.05769231</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="co">#&gt; 16   Q-B 0.03846154</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="co">#&gt; 17   R-B 0.05769231</span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="co">#&gt; 18   S-B 0.07692308</span></a>
<a class="sourceLine" id="cb12-34" data-line-number="34"><span class="co">#&gt; 19   S-C 0.03846154</span></a>
<a class="sourceLine" id="cb12-35" data-line-number="35"><span class="co">#&gt; 20   T-B 0.01923077</span></a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="co">#&gt; 21   T-C 0.01923077</span></a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="co">#&gt; 22   V-B 0.01923077</span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38"><span class="co">#&gt; 23   W-B 0.03846154</span></a></code></pre></div>
<ul>
<li>
<code><a href="http://www.rdocumentation.org/packages/BaMORC/topics/calculate_mse">calculate_mse()</a></code>: calculates mean squared error for each correction value (step).</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">## chemicalShifts and aaFreq are predefined sample variables</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">## for demo purpose within the BaMORC Package.</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="http://www.rdocumentation.org/packages/BaMORC/topics/calculate_mse">calculate_mse</a></span>(<span class="dt">step_ca =</span> <span class="dv">1</span>, <span class="dt">step_cb =</span> <span class="dv">1</span>, <span class="dt">dat_cacb =</span> chemicalShifts[, </a>
<a class="sourceLine" id="cb13-4" data-line-number="4">    <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)], <span class="dt">aa_Freq =</span> aaFreq)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; [1] 0.0003151677</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#bamorc-quickstart-guide">BaMORC quickstart guide</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bamorc-basics">BaMORC basics</a></li>
      </ul>
</li>
      <li>
<a href="#the-data-processing">The data processing:</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-sample-generating-functions">The sample generating functions:</a></li>
      <li><a href="#the-reading-functions-will-return-sequence-and-chemical-shifts">The reading functions will return sequence and chemical shifts:</a></li>
      <li><a href="#estimating-econdary-structure-from-sequence">Estimating econdary structure from sequence:</a></li>
      <li><a href="#behind-the-scenes-functions">Behind-the-scenes functions</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xi Chen, Andrey Smelter, Hunter Moseley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
